{% extends "admin_layout.html" %}
{% block content %}

<div class="dash-head">
    <h2>–î–∞—à–±–æ—Ä–¥</h2>
    <div class="dash-sub">–°–≤–æ–¥–∫–∞ –∑–∞ 7 –¥–Ω–µ–π –∏ –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</div>
</div>

<div class="dash-grid">
    <div class="dash-card">
        <div class="dash-kpi-title">–ó–∞—è–≤–∫–∏</div>
        <div class="dash-kpi-main">{{ stats.enrolls_total }}</div>
        <div class="dash-kpi-sub">–∑–∞ 7 –¥–Ω–µ–π: <b>{{ stats.enrolls_7d }}</b></div>
        <div class="dash-actions">
            <a class="admin-btn" href="{{ url_for('admin_enrolls') }}">–û—Ç–∫—Ä—ã—Ç—å</a>
        </div>
    </div>

    <div class="dash-card">
        <div class="dash-kpi-title">–ë–æ—Ç—ã</div>
        <div class="dash-kpi-main">{{ stats.bots_total }}</div>
        <div class="dash-kpi-sub">–∑–∞ 7 –¥–Ω–µ–π: <b>{{ stats.bots_7d }}</b></div>
        <div class="dash-actions">
            <a class="admin-btn" href="{{ url_for('admin_enrolls') }}">–ó–∞—è–≤–∫–∏</a>
        </div>
    </div>

    <div class="dash-card">
        <div class="dash-kpi-title">–£—á–µ–Ω–∏–∫–∏</div>
        <div class="dash-kpi-main">{{ stats.students_total }}</div>
        <div class="dash-kpi-sub">–±–µ–∑ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è: <b>{{ stats.students_no_teacher }}</b></div>
        <div class="dash-actions">
            <a class="admin-btn" href="{{ url_for('teacher_students') }}">–£—á–µ–Ω–∏–∫–∏</a>
        </div>
    </div>

    <div class="dash-card">
        <div class="dash-kpi-title">–î–æ–º–∞—à–∫–∏</div>
        <div class="dash-kpi-main">{{ stats.hw_new }}</div>
        <div class="dash-kpi-sub">–Ω–æ–≤—ã—Ö ¬∑ –∑–∞ 7 –¥–Ω–µ–π: <b>{{ stats.hw_7d }}</b></div>
        <div class="dash-actions">
            <a class="admin-btn" href="{{ url_for('teacher_homework_list') }}">–û—Ç–∫—Ä—ã—Ç—å</a>
        </div>
    </div>

    <div class="dash-card">
        <div class="dash-kpi-title">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
        <div class="dash-kpi-main">{{ stats.materials_published }}</div>
        <div class="dash-kpi-sub">–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ ¬∑ –≤—Å–µ–≥–æ: <b>{{ stats.materials_total }}</b></div>
        <div class="dash-actions">
            <a class="admin-btn" href="{{ url_for('admin_materials') }}">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</a>
        </div>
    </div>
</div>

<div class="dash-rows">
    <div class="dash-panel">
        <div class="dash-panel-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏</div>

        <div class="dash-list">
            {% for e in last_enrolls %}
            <div class="dash-item">
                <div class="dash-item-main">
                    <b>#{{ e.id }}</b> {{ e.name }} ¬∑ <span class="admin-meta">{{ e.contact }}</span>
                    {% if e.is_bot %}<span class="bot-badge is-bot" style="margin-left:10px;"><span class="dot"></span>
                        BOT</span>{% endif %}
                </div>
                <div class="dash-item-sub">{{ e.created_at }}</div>
            </div>
            {% else %}
            <div class="dash-empty">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞—è–≤–æ–∫.</div>
            {% endfor %}
        </div>

        <div class="dash-panel-actions">
            <a class="btn-link" href="{{ url_for('admin_enrolls') }}">–í—Å–µ –∑–∞—è–≤–∫–∏ ‚Üí</a>
        </div>
    </div>

    <div class="dash-panel">
        <div class="dash-panel-title">–ù–æ–≤—ã–µ –¥–æ–º–∞—à–∫–∏</div>

        <div class="dash-list">
            {% for h in hw_new_list %}
            <div class="dash-item">
                <div class="dash-item-main">
                    <b>#{{ h.id }}</b> {{ h.student_name }}
                    {% if h.student_code %}<span class="admin-meta">({{ h.student_code }})</span>{% endif %}
                </div>
                <div class="dash-item-sub">{{ h.created_at }} ¬∑ {{ h.title or '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è' }}</div>
            </div>
            {% else %}
            <div class="dash-empty">–ù–æ–≤—ã—Ö –¥–æ–º–∞—à–µ–∫ –Ω–µ—Ç üéâ</div>
            {% endfor %}
        </div>

        <div class="dash-panel-actions">
            <a class="btn-link" href="{{ url_for('teacher_homework_list') }}">–í—Å–µ –¥–æ–º–∞—à–∫–∏ ‚Üí</a>
        </div>
    </div>
</div>

{% endblock %}