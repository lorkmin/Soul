{% extends "admin_layout.html" %} {% block content %}
<div class="top-actions">
  <div>–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫: {{ enrolls|length }}</div>
  <div>
    <a class="btn-link" href="{{ url_for('admin_enrolls_export') }}"
      >–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</a
    >
  </div>
</div>

<table class="admin-table">
  <thead>
    <tr>
      <th>#</th>
      <th>–î–∞—Ç–∞ / IP</th>
      <th>–ò–º—è / –ö–æ–Ω—Ç–∞–∫—Ç</th>
      <th>–ü–∞–∫–µ—Ç / –£—Ä–æ–≤–µ–Ω—å</th>
      <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
      <th class="admin-col-bot">–ë–æ—Ç</th>
      <th style="width: 320px">–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
  </thead>

  <tbody>
    {% for e in enrolls %}
    <tr class="{% if e.is_bot %}enroll-is-bot{% endif %}">
      <td>{{ e.id }}</td>

      <td>
        <div>{{ e.created_at }}</div>
        <div class="admin-meta">{{ e.ip }}</div>
      </td>

      <td>
        <div>{{ e.name }}</div>
        <div class="admin-meta">{{ e.contact }}</div>
      </td>

      <td>
        <div>{{ e.tariff or "‚Äî" }}</div>
        <div class="admin-meta">{{ e.level or "‚Äî" }}</div>
      </td>

      <td>{{ e.comment or "" }}</td>

      <!-- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü "–ë–æ—Ç" -->
      <td style="white-space: nowrap">
        {% if e.is_bot %}
        <span class="bot-badge">ü§ñ –ë–û–¢</span>
        {% else %}
        <span class="bot-badge bot-badge--off">‚Äî</span>
        {% endif %}
      </td>

      <!-- ‚úÖ –î–µ–π—Å—Ç–≤–∏—è: –æ–¥–Ω–∞ —Ñ–æ—Ä–º–∞ –Ω–∞ —Å—Ç—Ä–æ–∫—É -->
      <td class="enroll-actions-cell">
        <form
          method="post"
          action="{{ url_for('admin_enroll_note', enroll_id=e.id) }}"
          class="enroll-actions-form"
        >
          <label class="bot-toggle">
            <input
              type="checkbox"
              name="is_bot"
              value="1"
              {%
              if
              e.is_bot
              %}checked{%
              endif
              %}
            />
            <span class="bot-toggle-ui"></span>
            <span class="bot-toggle-text">–≠—Ç–æ –±–æ—Ç</span>
          </label>

          <input
            type="text"
            name="admin_note"
            class="admin-note-input"
            placeholder="–ó–∞–º–µ—Ç–∫–∞ –∞–¥–º–∏–Ω–∞ (–¥–ª—è —Å–µ–±—è)"
            value="{{ e.admin_note or '' }}"
          />

          <button type="submit" class="admin-btn admin-btn-save">
            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
          </button>
        </form>
      </td>
    </tr>

    {% else %}
    <tr>
      <td colspan="7">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞—è–≤–æ–∫.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
