<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>–õ–∏—á–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ —É—á–µ–Ω–∏–∫–∞ ‚Äî Soul</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style_light.css') }}"
    />
  </head>
  <body class="student-dashboard">
    <div class="wrapper">
      <section>
        <div class="section-inner">
          <div class="section-title">
            <h3>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —É—á–µ–Ω–∏–∫–∞</h3>
            <span>–ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–∞—à–∏ –æ–ø–ª–∞—Ç—ã –∏ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–Ω—è—Ç–∏—è</span>
          </div>

          <div class="enroll-box" style="max-width: 520px">
            <form method="post">
              <div class="form-field">
                <label for="code">–í–∞—à 6-–∑–Ω–∞—á–Ω—ã–π ID</label>
                <input
                  id="code"
                  name="code"
                  type="text"
                  maxlength="6"
                  placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, 038421"
                  value="{{ code or '' }}"
                  required
                />
              </div>
              <button class="btn-primary form-submit" type="submit">
                –ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
              </button>
            </form>

            {% if not_found %}
            <p style="color: #c00; margin-top: 10px">
              –ó–∞–ø–∏—Å—å —Å —Ç–∞–∫–∏–º ID –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥ –∏–ª–∏ —Å–ø—Ä–æ—Å–∏—Ç–µ —É
              –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è.
            </p>
            {% endif %} {% if student %}
            <hr
              style="
                margin: 20px 0;
                border: none;
                border-top: 1px solid rgba(0, 0, 0, 0.06);
              "
            />

            <h4 style="margin-bottom: 10px">
              {{ student['name'] or '–£—á–µ–Ω–∏–∫' }}
            </h4>

            {% if student['course'] %}
            <p style="margin: 0 0 10px 0; color: #666">
              –ö—É—Ä—Å: {{ student['course'] }}
            </p>
            {% endif %}

            <p>
              <strong>–í—Å–µ–≥–æ –∑–∞–Ω—è—Ç–∏–π –≤ –ø–∞–∫–µ—Ç–µ:</strong>
              {{ student['lessons_total'] or '‚Äî' }}
            </p>
            <p>
              <strong>–û—Å—Ç–∞–ª–æ—Å—å –∑–∞–Ω—è—Ç–∏–π:</strong>
              {{ student['lessons_left'] or '‚Äî' }}
            </p>
            {# –ü–†–û–ì–†–ï–°–° –ü–û –ó–ê–ù–Ø–¢–ò–Ø–ú #} {% set total = (student['lessons_total']
            or 0)|int %} {% set left = (student['lessons_left'] or 0)|int %} {%
            if total > 0 %} {% set done = total - left %} {% if done < 0 %}{%
            set done = 0 %}{% endif %} {% if done > total %}{% set done = total
            %}{% endif %} {% set percent = (done * 100 / total)|round(0) %}

            <div class="student-progress">
              <div class="student-progress-top">
                <span class="student-progress-label"> –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –ø–∞–∫–µ—Ç—É </span>
                <span class="student-progress-percent">
                  {{ percent|int }}%
                </span>
              </div>
              <div class="student-progress-bar">
                <div
                  class="student-progress-fill"
                  style="width: {{ percent }}%;"
                ></div>
              </div>
              <div class="student-progress-meta">
                –ü—Ä–æ–π–¥–µ–Ω–æ {{ done }} –∏–∑ {{ total }} –∑–∞–Ω—è—Ç–∏–π
              </div>
            </div>
            {% endif %} {# --- –ê–ß–ò–í–ö–ò --- #} {% set done_count =
            lessons_done|length %} {% set total = (student['lessons_total'] or
            0)|int %} {% set left = (student['lessons_left'] or 0)|int %} {% if
            total > 0 %} {% set done = total - left %} {% if done < 0 %}{% set
            done = 0 %}{% endif %} {% if done > total %}{% set done = total %}{%
            endif %} {% set percent = (done * 100 / total)|round(0)|int %} {%
            else %} {% set done = done_count %} {% set percent = 0 %} {% endif
            %} {% if done_count > 0 or total > 0 %}
            <div class="student-achievements">
              <div class="student-achievements-title">
                –í–∞—à–∏ –º–∞–ª–µ–Ω—å–∫–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
              </div>
              <ul class="student-achievements-list">
                {% if done_count >= 1 %}
                <li>
                  <span class="badge-icon">üå±</span>
                  <span class="badge-text"
                    >–ü–µ—Ä–≤—ã–π —à–∞–≥ ‚Äî –≤—ã —É–∂–µ –Ω–∞—á–∞–ª–∏ –∫—É—Ä—Å!</span
                  >
                </li>
                {% endif %} {% if done_count >= 3 %}
                <li>
                  <span class="badge-icon">üî•</span>
                  <span class="badge-text"
                    >–¢—Ä–∏ –∑–∞–Ω—è—Ç–∏—è –ø–æ–∑–∞–¥–∏ ‚Äî –≤—ã –¥–µ—Ä–∂–∏—Ç–µ —Ä–∏—Ç–º üí™</span
                  >
                </li>
                {% endif %} {% if percent >= 50 and percent < 100 %}
                <li>
                  <span class="badge-icon">üåà</span>
                  <span class="badge-text"
                    >–ü–æ–ª–æ–≤–∏–Ω–∞ –∫—É—Ä—Å–∞ –ø—Ä–æ–π–¥–µ–Ω–∞ ‚Äî –≤—ã —É–∂–µ –¥–∞–ª–µ–∫–æ –ø—Ä–æ–¥–≤–∏–Ω—É–ª–∏—Å—å!</span
                  >
                </li>
                {% endif %} {% if percent >= 90 and left > 0 %}
                <li>
                  <span class="badge-icon">üöÄ</span>
                  <span class="badge-text"
                    >–§–∏–Ω–∏—à –±–ª–∏–∑–∫–æ ‚Äî –æ—Å—Ç–∞–ª–æ—Å—å –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–Ω—è—Ç–∏–π.</span
                  >
                </li>
                {% endif %} {% if total > 0 and left == 0 and done > 0 %}
                <li>
                  <span class="badge-icon">üèÖ</span>
                  <span class="badge-text"
                    >–í—ã –ø—Ä–æ—à–ª–∏ –≤–µ—Å—å –ø–∞–∫–µ—Ç ‚Äî –º–æ–ª–æ–¥–µ—Ü!</span
                  >
                </li>
                {% endif %}
              </ul>
            </div>
            {% endif %}

            <p style="margin-top: 10px">
              <strong>–ü–æ—Å–ª–µ–¥–Ω—è—è –æ–ø–ª–∞—Ç–∞:</strong>
              {{ student['last_payment_date'] or '‚Äî' }} {% if
              student['last_payment_amount'] %} ¬∑ {{
              student['last_payment_amount'] }} ‚ÇΩ {% endif %}
            </p>

            {% if student['comment'] %}
            <p style="margin-top: 10px; color: #777">
              –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —à–∫–æ–ª—ã:<br />{{ student['comment'] }}
            </p>
            {% endif %}

            <!-- –†–ê–°–ü–ò–°–ê–ù–ò–ï –ó–ê–ù–Ø–¢–ò–ô -->
            <hr
              style="
                margin: 18px 0;
                border: none;
                border-top: 1px solid rgba(0, 0, 0, 0.06);
              "
            />

            <h4 style="margin-bottom: 8px">–í–∞—à–∏ –∑–∞–Ω—è—Ç–∏—è</h4>

            {% if lessons_planned or lessons_rescheduled or lessons_done or
            lessons_canceled %}
            <div class="student-lessons-sections">
              {% if lessons_planned %}
              <div class="student-lessons-section">
                <p class="student-lessons-label">–ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–Ω—è—Ç–∏—è</p>
                <ul class="student-lessons-list">
                  {% for l in lessons_planned %}
                  <li
                    class="lesson-row {% if loop.first %}lesson-next{% endif %}"
                  >
                    <div class="lesson-main">
                      <div>
                        {% if loop.first %}
                        <span class="lesson-next-badge">–°–∫–æ—Ä–æ</span>
                        {% endif %}
                        <span class="lesson-date">{{ l['start_at'] }}</span>
                        {% if l['topic'] %}
                        <span class="lesson-dot">‚Ä¢</span>
                        <span class="lesson-topic">{{ l['topic'] }}</span>
                        {% endif %}
                      </div>

                      {% if l['comment'] %}
                      <div class="lesson-comment">{{ l['comment'] }}</div>
                      {% endif %}
                    </div>

                    <span class="lesson-status-badge lesson-status-planned"
                      >–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ</span
                    >
                  </li>
                  {% endfor %}
                </ul>
              </div>
              {% endif %} {% if lessons_rescheduled %}
              <div class="student-lessons-section">
                <p class="student-lessons-label">–ü–µ—Ä–µ–Ω–µ—Å—ë–Ω–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è</p>
                <ul class="student-lessons-list">
                  {% for l in lessons_rescheduled %}
                  <li class="lesson-row">
                    <div class="lesson-main">
                      <span class="lesson-date">{{ l['start_at'] }}</span>
                      {% if l['rescheduled_to'] %}
                      <span class="lesson-arrow">‚Üí</span>
                      <span class="lesson-date">{{ l['rescheduled_to'] }}</span>
                      {% endif %} {% if l['topic'] %}
                      <span class="lesson-dot">‚Ä¢</span>
                      <span class="lesson-topic">{{ l['topic'] }}</span>
                      {% endif %} {% if l['comment'] %}
                      <div class="lesson-comment">{{ l['comment'] }}</div>
                      {% endif %}
                    </div>
                    <span class="lesson-status-badge lesson-status-rescheduled">
                      –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ
                    </span>
                  </li>
                  {% endfor %}
                </ul>
              </div>
              {% endif %} {% if lessons_done %}
              <div class="student-lessons-section">
                <p class="student-lessons-label">–ü—Ä–æ–≤–µ–¥—ë–Ω–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è</p>
                <ul class="student-lessons-list">
                  {% for l in lessons_done %}
                  <li class="lesson-row">
                    <div class="lesson-main">
                      <span class="lesson-date">{{ l['start_at'] }}</span>
                      {% if l['topic'] %}
                      <span class="lesson-dot">‚Ä¢</span>
                      <span class="lesson-topic">{{ l['topic'] }}</span>
                      {% endif %} {% if l['comment'] %}
                      <div class="lesson-comment">{{ l['comment'] }}</div>
                      {% endif %}
                    </div>
                    <span class="lesson-status-badge lesson-status-done">
                      –ü—Ä–æ–≤–µ–¥–µ–Ω–æ
                    </span>
                  </li>
                  {% endfor %}
                </ul>
              </div>
              {% endif %} {% if lessons_canceled %}
              <div class="student-lessons-section">
                <p class="student-lessons-label">–û—Ç–º–µ–Ω—ë–Ω–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è</p>
                <ul class="student-lessons-list">
                  {% for l in lessons_canceled %}
                  <li class="lesson-row">
                    <div class="lesson-main">
                      <span class="lesson-date">{{ l['start_at'] }}</span>
                      {% if l['topic'] %}
                      <span class="lesson-dot">‚Ä¢</span>
                      <span class="lesson-topic">{{ l['topic'] }}</span>
                      {% endif %} {% if l['comment'] %}
                      <div class="lesson-comment">{{ l['comment'] }}</div>
                      {% endif %}
                    </div>
                    <span class="lesson-status-badge lesson-status-canceled">
                      –û—Ç–º–µ–Ω–µ–Ω–æ
                    </span>
                  </li>
                  {% endfor %}
                </ul>
              </div>
              {% endif %}
            </div>
            {% else %}
            <p style="font-size: 0.9rem; color: #777; margin-top: 6px">
              –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ. –°–ø—Ä–æ—Å–∏—Ç–µ —É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è, –∫–æ–≥–¥–∞
              –±—É–¥–µ—Ç –±–ª–∏–∂–∞–π—à–µ–µ –∑–∞–Ω—è—Ç–∏–µ üôÇ
            </p>
            {% endif %} {% endif %}
          </div>
        </div>
      </section>
    </div>
  </body>
</html>
